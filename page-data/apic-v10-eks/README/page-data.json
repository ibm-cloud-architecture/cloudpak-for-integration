{"componentChunkName":"component---src-templates-docs-js","path":"/apic-v10-eks/README","result":{"data":{"site":{"siteMetadata":{"title":"Cloud Pak for Integration | IBM","docsLocation":"https://github.com/ibm-cloud-architecture/cloudpak-for-integration"}},"mdx":{"fields":{"id":"cbc12435-120f-5b05-acc6-d876b924f360","title":"README","slug":"/apic-v10-eks/README"},"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h3\", null, \"Install APIC V10 on Amazon EKS\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#install-apic-v10-on-amazon-eks\"\n  }), \"Install APIC V10 on Amazon EKS\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#summary\"\n  }), \"Summary\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#create-eks-cluster\"\n  }), \"Create EKS Cluster\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#download-apic-related-crds\"\n  }), \"Download APIC Related CRDs\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#install-ingress-and-cert-manager\"\n  }), \"Install Ingress and Cert Manager\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#configure-route53-dns\"\n  }), \"Configure Route53 DNS\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#apply-crds-and-customize-apic-subsystem-deployment\"\n  }), \"Apply CRDs and Customize APIC Subsystem Deployment\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#update-node-vmmax_map_count\"\n  }), \"Update Node vm.max_map_count\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#cluster-accessmanagement\"\n  }), \"Cluster Access/Management\"), mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#logging-into-a-cluster-node\"\n  }), \"Logging into a Cluster Node\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#cluster-access\"\n  }), \"Cluster Access\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#deleting-cluster\"\n  }), \"Deleting Cluster\")))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#references\"\n  }), \"References\"))), mdx(\"h3\", null, \"Summary\"), mdx(\"p\", null, \"This guide is a quick and consolidated reference on how to install APIC on EKS. This will create a cluster for the purposes of DEV and POC. The cluster sizing, profiles and licenses selected in the sample files are not meant to be used for a production cluster.\"), mdx(\"p\", null, \"Always refere to the Knowledge Center for installation details: \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.ibm.com/support/knowledgecenter/SSMNED_v10/com.ibm.apic.install.doc/tapic_install_Kubernetes.html\"\n  }), \"https://www.ibm.com/support/knowledgecenter/SSMNED_v10/com.ibm.apic.install.doc/tapic_install_Kubernetes.html\")), mdx(\"p\", null, \"Assumptions:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Non-Prod license and sizing\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Online install using IBM entitled registry (image mirror steps are not covered)\")), mdx(\"p\", null, \"Prerequisites:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"CLI\", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"kubectl\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"eksctl\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"helm\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"aws (cli)\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"aws-iam-authenticator (cli)\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"General Access\", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"IBM entitled container registry (ibm-entitlement-key)\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"IBM Fix Central (for APIC CRDs)\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Route53 public hosted zone with domain for creating wildcard subdomain A record\")))), mdx(\"h3\", null, \"Create EKS Cluster\"), mdx(\"p\", null, \"Using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"eksctl\"), \" is the easiest way to spin up an EKS cluster. This command will create a cluster using node profile\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"c5.4xlarge\"), \" of the following spec - CPU: 16, Memory: 32 Gib, Storage: EBS-Only, Network GBPs: Up to 10, EBS Mbs: 4,750.\"), mdx(\"p\", null, \"Refer to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"eksctl\"), \" doc for more information. \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://eksctl.io/usage/creating-and-managing-clusters/\"\n  }), \"https://eksctl.io/usage/creating-and-managing-clusters/\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"eksctl create cluster --name apic-eks --region us-east-1 --nodegroup-name apic-workers \\\\\\n                      --node-type c5.4xlarge --nodes 2 --ssh-access \\\\\\n                      --node-volume-size 120\\n\")), mdx(\"h3\", null, \"Download APIC Related CRDs\"), mdx(\"p\", null, \"Follow directions from the Knowledge Center and download the needed files.\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.ibm.com/support/knowledgecenter/SSMNED_v10/com.ibm.apic.install.doc/tapic_install_Kubernetes_firststeps.html\"\n  }), \"https://www.ibm.com/support/knowledgecenter/SSMNED_v10/com.ibm.apic.install.doc/tapic_install_Kubernetes_firststeps.html\")), mdx(\"p\", null, \"For the purpose of this guide, some of the file samples are in this repo under directory \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"sample-files\"), \". Other referenced files will be available in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"apiconnect-operator-release-files_v10.0.1.0.zip\"), \" (and within it the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"helper_files.zip\"), \") which can be downloaded from Fix Central.\"), mdx(\"h3\", null, \"Install Ingress and Cert Manager\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"# Install Nginx ingress controller - ingress-config.yml\\nhelm install ingress stable/nginx-ingress --values ./sample-files/ingress-config.yml --namespace kube-system\\n\\n# Create namespace for APIC\\nkubectl create ns apic\\nkubectl config set-context --current --namespace=apic\\n\\n# Install cert manager and ingress issuers\\nkubectl apply -f cert-manager-0.10.1.yaml\\nkubectl apply -f ingress-issuer-v1-alpha1.yaml -n apic\\n\\n# Check the certs are created\\nkubectl get certificates -n apic\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"NAME \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 READY \\xA0 SECRET \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 AGE\\nanalytics-client-client\\xA0 \\xA0 \\xA0 True\\xA0 \\xA0 analytics-client-client\\xA0 \\xA0 \\xA0 5m36s\\nanalytics-ingestion-client \\xA0 True\\xA0 \\xA0 analytics-ingestion-client \\xA0 5m36s\\ngateway-client-client\\xA0 \\xA0 \\xA0 \\xA0 True\\xA0 \\xA0 gateway-client-client\\xA0 \\xA0 \\xA0 \\xA0 5m36s\\ngateway-peering\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 True\\xA0 \\xA0 gateway-peering\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 5m36s\\ngateway-service\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 True\\xA0 \\xA0 gateway-service\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 5m36s\\ningress-ca \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 True\\xA0 \\xA0 ingress-ca \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 5m36s\\nportal-admin-client\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 True\\xA0 \\xA0 portal-admin-client\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 5m36s\\n\")), mdx(\"p\", null, \"You should see the ELB and its external IP created by AWS when you run the following:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"$ kubectl get svc -n kube-system       \\nNAME                                    TYPE           CLUSTER-IP      EXTERNAL-IP                                                               PORT(S)                      AGE\\ningress-nginx-ingress-controller        LoadBalancer   10.100.113.63   afba042c90aa446c29917e5930bb1d73-2129028543.us-east-1.elb.amazonaws.com   80:31751/TCP,443:30345/TCP   4d7h\\ningress-nginx-ingress-default-backend   ClusterIP      10.100.167.4    <none>                                                                    80/TCP                       4d7h\\nkube-dns                                ClusterIP      10.100.0.10     <none>                                                                    53/UDP,53/TCP                4d8h\\n\")), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.ibm.com/support/knowledgecenter/SSMNED_v10/com.ibm.apic.install.doc/tapic_install_K8s_ingress_ctl_reqs.html\"\n  }), \"https://www.ibm.com/support/knowledgecenter/SSMNED_v10/com.ibm.apic.install.doc/tapic_install_K8s_ingress_ctl_reqs.html\")), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.ibm.com/support/knowledgecenter/SSMNED_v10/com.ibm.apic.install.doc/tapic_install_certmgr.html\"\n  }), \"https://www.ibm.com/support/knowledgecenter/SSMNED_v10/com.ibm.apic.install.doc/tapic_install_certmgr.html\")), mdx(\"h3\", null, \"Configure Route53 DNS\"), mdx(\"p\", null, \"Assuming the account has a Route53 public domain, we can create a wildcard subodmain record with name \\\"\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"*.apic-eks-3node\"), \"\\\" that points to the ELB created by the ingress controller above.  This will be the subdomain hostname that we'll configured for the hosts field in the CR customization in the yaml files.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1035px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/cloudpak-for-integration/static/c9bf2079475ae4d3d8ad8823662cf1a9/d7e70/route53.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"111.1969111969112%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAABYlAAAWJQFJUiTwAAAC4UlEQVQ4y41UyY7TQBDN33JD4sIP8C0cEBJHziAOXOY2GQZmsi/O4nhf4614r9rtZFAkxtJLtdPu6qr3qmoUJ4mkWabI8/yCopAM9lXAWdokTWVER4vFUsbjB3l6nsj9/Vgm06muy7KU8/n8X/C7KI4lQXDqMIXnMAwljCK9jR8QXdeJCCFqh/fusqZt2kaaptEsR0xvfzhqRM+TGZzG4vmB2iCMdH3yfLV+EIrXr+1ehO+qulbHpEkduidPdvsjOMgkjpPhsIFxSAfkiJbgXkBgzXSZujq0ZG62W3F2Ozje641t2w7gE+OQ4zjinU5SY//WQ1/KIReMSlPAwTTLYROJk1QKFaYCz5lGSo4ZieHwhkP++HC03mxkvz+oZSqMrAbRtIy4tsB/VVXpfwquAV6Q5X3KFIWCzJcrxWq9geMtaHBkDRzdk0ZIoRg1hUhgCXLO/4sSHCaRccj0ts4OcNTRDpHynZwuV2uZo04939fobJR1HyHXJQTJilKy2IdDcMJusY4YHQWiOMejaw4ipaZPn2hokWLb2zP2ma6qrIWNKOlsMp0pZvOFTGdzrU1G7ez2+s5LbeSGFkMN95nl4JBdwW4hJ5ZkwrSWWds2HPZ6mHdTZoPKvPXx95PeWhSlCsAiZ/m8HAIGKkhqBooVRjvF1qGKgrAP4MxF4QZ9h7CDWFJst5PnQW1X19y/Lh3WKtPNbYQs6Cl5U+4WMoOqBEuJnC5QSuRqAcWpOte2BQkWPCMeOOQLb9V0ei5pbZq2/a6frp843TB5rlovQHqqGrBCBFTNdEH9YuZpaigPO96K3rL0Ki0dOGSYSzhiehuIc3Q9Q34vBAWiEzvVuZfmnObkDQJmhYIBDCqztSjGrYa/+XSgoK2A+gIMW142Yv295mFqBxftl8eSfXkvyae3kn5+p0g+vpHi6wczHFgyVoRUkf2DVFNle3IIJHEk4Z+fEvz6LuHjD0Xw8E2iyZ1E+OYv68OUwfHgIZUAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"route53-wildcard\",\n    \"title\": \"route53-wildcard\",\n    \"src\": \"/cloudpak-for-integration/static/c9bf2079475ae4d3d8ad8823662cf1a9/e3189/route53.png\",\n    \"srcSet\": [\"/cloudpak-for-integration/static/c9bf2079475ae4d3d8ad8823662cf1a9/a2ead/route53.png 259w\", \"/cloudpak-for-integration/static/c9bf2079475ae4d3d8ad8823662cf1a9/6b9fd/route53.png 518w\", \"/cloudpak-for-integration/static/c9bf2079475ae4d3d8ad8823662cf1a9/e3189/route53.png 1035w\", \"/cloudpak-for-integration/static/c9bf2079475ae4d3d8ad8823662cf1a9/d7e70/route53.png 1286w\"],\n    \"sizes\": \"(max-width: 1035px) 100vw, 1035px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \")), mdx(\"h3\", null, \"Apply CRDs and Customize APIC Subsystem Deployment\"), mdx(\"p\", null, \"I've created custom CRs for the this guide. Please\\nmodify the values in each CR that's being applied as needed.\"), mdx(\"p\", null, \"NOTE: for the four files \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"*_cr.yaml\"), \" under \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"sample-files\"), \", replace \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$HOSTNAME\"), \" with the wildcard domain that we created above (e.g. \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"apic-eks-3node.example.com\"), \" for this example) \"), mdx(\"p\", null, \"Other files are available in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"apiconnect-operator-release-files_v10.0.1.0.zip\"), \" (and within it the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"helper_files.zip\"), \") which can be downloaded from Fix Central.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"kubectl apply -f ibm-apiconnect-crds.yaml\\n\\n# In this guide I'll be using the entitled registry, so\\n# we'll need a pull secret for the images\\nkubectl create secret docker-registry ibm-entitlement-key --docker-server=cp.icr.io \\\\\\n        --docker-username=cp --docker-password=<ENTITLEMENT_KEY> -n apic\\n\\n\\n# Install Operators in APIC namespace, pointing to entitled registry and uses IBM entitlement key by default\\n\\nkubectl apply -f ./sample-files/ibm-apiconnect.yaml\\nkubectl apply -f ./sample-files/ibm-datapower.yaml\\n\\n# Edit CRs and apply them\\nkubectl apply -f ./sample-files/management_cr.yaml\\nkubectl apply -f ./sample-files/portal_cr.yaml\\n# Gateway\\nkubectl apply -f ./sample-files/dp-admin-secret.yaml\\nkubectl apply -f ./sample-files/apigateway_cr.yaml\\nkubectl apply -f ./sample-files/analytics_cr.yaml\\n\")), mdx(\"p\", null, \"After the deployment is complete, you should see something like the following when running \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"kubectl get pods\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"$ kubectl get pods\\nNAME                                                              READY   STATUS      RESTARTS   AGE\\nanalytics-cj-rollover-1603388700-hxlnt                            0/1     Completed   0          15m\\nanalytics-client-cdfd8f94f-wjhmp                                  1/1     Running     0          4h11m\\nanalytics-ingestion-b4459548d-5xcp6                               1/1     Running     0          4h11m\\nanalytics-mtls-gw-695856497d-4dntr                                1/1     Running     0          4h10m\\nanalytics-storage-coord-9f75d69d6-jrz7j                           1/1     Running     0          4h11m\\nanalytics-storage-data-0                                          1/1     Running     0          4h11m\\nanalytics-storage-master-0                                        1/1     Running     0          4h11m\\nbackrest-backup-management-2a4f97b9-postgres-t2bt2                0/1     Completed   0          29h\\ndatapower-operator-6856f485bb-fjntd                               1/1     Running     0          3h20m\\ndatapower-operator-conversion-webhook-78bdbcdc59-2gpqk            1/1     Running     0          3h20m\\ngateway-0                                                         1/1     Running     0          29h\\nibm-apiconnect-6579f568f-kvth2                                    1/1     Running     0          29h\\nmanagement-2a4f97b9-postgres-757f467dff-4lzxx                     1/1     Running     0          29h\\nmanagement-2a4f97b9-postgres-backrest-shared-repo-6ff9759dwgjvn   1/1     Running     0          29h\\nmanagement-2a4f97b9-postgres-pgbouncer-7b6c7b7548-s6vc8           1/1     Running     0          29h\\nmanagement-2a4f97b9-postgres-stanza-create-75r4d                  0/1     Completed   0          29h\\nmanagement-analytics-proxy-5cfc5d9c87-5vwql                       1/1     Running     0          28h\\nmanagement-apim-8676f6d79b-gg2nr                                  1/1     Running     0          28h\\nmanagement-client-downloads-server-56464d597c-78sgz               1/1     Running     0          29h\\nmanagement-juhu-cf497ff98-hbmrb                                   1/1     Running     0          28h\\nmanagement-ldap-cf4fc7bc-mzp5c                                    1/1     Running     0          29h\\nmanagement-lur-767c6b7b74-v9gjn                                   1/1     Running     0          28h\\nmanagement-nats-operator-66b97844dd-gzhr6                         1/1     Running     0          29h\\nmanagement-nats-streaming-operator-5d77b5fc66-4frj5               1/1     Running     0          29h\\nmanagement-natscluster-1                                          1/1     Running     0          29h\\nmanagement-portal-proxy-78884ddfc-fstjj                           1/1     Running     0          28h\\nmanagement-stancluster-1                                          1/1     Running     0          29h\\nmanagement-taskmanager-644dfd48b5-rmb8n                           1/1     Running     0          28h\\nmanagement-ui-698dd4f45c-gz7qt                                    1/1     Running     0          29h\\nmanagement-up-apim-data-populate-0-to-6-8055ab6f-wlv7g            0/1     Completed   0          29h\\nmanagement-up-apim-schema-0-to-6-8055ab6f-q9bm6                   0/1     Completed   0          29h\\nmanagement-up-lur-data-populate-0-to-2-8055ab6f-p4m8t             0/1     Completed   0          29h\\nmanagement-up-lur-schema-0-to-2-8055ab6f-l895h                    0/1     Completed   0          29h\\nportal-5727ffec-db-0                                              2/2     Running     0          29h\\nportal-5727ffec-www-0                                             2/2     Running     0          29h\\nportal-nginx-675d6c6c69-g8xtm                                     1/1     Running     0          29h\\npostgres-operator-5b946c9c5-hk7lz                                 4/4     Running     0          29h\\n\")), mdx(\"p\", null, \"Then you should be able to see the ingress URLs from running \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"kubectl get ingress\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"$ kubectl get ingress\\nNAME                      HOSTS                                   ADDRESS   PORTS     AGE\\nanalytics-ac-endpoint     ac.apic-eks-3node.example.com           1.2.3.4   80, 443   4h50m\\nanalytics-ai-endpoint     ai.apic-eks-3node.example.com           1.2.3.4   80, 443   4h50m\\ngateway-gateway           rgw.apic-eks-3node.example.com          1.2.3.4   80, 443   29h\\ngateway-gateway-manager   rgwd.apic-eks-3node.example.com         1.2.3.4   80, 443   29h\\nmanagement-admin          admin.apic-eks-3node.example.com        1.2.3.4   80, 443   29h\\nmanagement-api-manager    manager.apic-eks-3node.example.com      1.2.3.4   80, 443   29h\\nmanagement-consumer-api   consumer.apic-eks-3node.example.com     1.2.3.4   80, 443   29h\\nmanagement-platform-api   api.apic-eks-3node.example.com          1.2.3.4   80, 443   29h\\nportal-portal-director    api.portal.apic-eks-3node.example.com   1.2.3.4   80, 443   29h\\nportal-portal-web         portal.apic-eks-3node.example.com       1.2.3.4   80, 443   29h\\n\")), mdx(\"p\", null, \"Now we can navigate to the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"management-admin\"), \" URL (e.g. \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"admin.apic-eks-3node.example.com\"), \"), and follow the Cloud Manager setup checklist.\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.ibm.com/support/knowledgecenter/SSMNED_v10/com.ibm.apic.cmc.doc/rapic_cmc_checklist.html\"\n  }), \"https://www.ibm.com/support/knowledgecenter/SSMNED_v10/com.ibm.apic.cmc.doc/rapic_cmc_checklist.html\")), mdx(\"h3\", null, \"Update Node vm.max_map_count\"), mdx(\"p\", null, \"For the analytics pods to come up successfully, we have to set \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vm.max_map_count\"), \" on each node. Here's a handy command to do that, assuming \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ssh\"), \" was enabled when the cluster is spun up, allowing the user to log in with the default SSH key/pair.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"# 7th field is the external IP of the nodes\\nkubectl get nodes -o wide --no-headers | awk '{print $7}' | xargs -I {} ssh-keyscan {} >> $HOME/.ssh/known_hosts\\nkubectl get nodes -o wide --no-headers | awk '{print $7}' | xargs -I {} ssh ec2-user@{} 'echo -e \\\"\\\\033[0;31m Setting {} \\\\033[0m\\\";sudo sysctl -w vm.max_map_count=262144; echo \\\"vm.max_map_count=262144\\\" | sudo tee -a /etc/sysctl.conf'\\n\")), mdx(\"h3\", null, \"Cluster Access/Management\"), mdx(\"h4\", null, \"Logging into a Cluster Node\"), mdx(\"p\", null, \"Since we allowed SSH login from \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"eksctl create cluster\"), \" command, we\\ncan login to the nodes and adjust node settings with \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ec2-user\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"# Get the public IPS for the node\\nkubectl get nodes -o wide\\n\\nssh ec2-user@54.196.40.41\\n\")), mdx(\"h4\", null, \"Cluster Access\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"$ aws configure --profile=clusterAdmin\\nAWS Access Key ID [None]: <access-key-id>\\nAWS Secret Access Key [None]: <access-key>\\nDefault region name [None]: us-east-1\\nDefault output format [None]: json\\n\")), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"export AWS_PROFILE=clusterAdmin\")), mdx(\"p\", null, \"List Clusters\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"aws eks --region us-east-1 list-clusters\")), mdx(\"p\", null, \"Update kubeconfig with a different cluster\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"aws eks --region us-east-1 update-kubeconfig --name apic-eks-3node\")), mdx(\"h4\", null, \"Deleting Cluster\"), mdx(\"p\", null, \"Use the above commands to list out cluster names\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"eksctl delete cluster --name <cluster-name>\")), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.aws.amazon.com/eks/latest/userguide/delete-cluster.html\"\n  }), \"https://docs.aws.amazon.com/eks/latest/userguide/delete-cluster.html\")), mdx(\"h3\", null, \"References\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Internal V10 EKS Install Guide\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.ibm.com/apiconnect-field/apicv10EKS\"\n  }), \"https://github.ibm.com/apiconnect-field/apicv10EKS\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"AWS Instance Types\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://aws.amazon.com/ec2/instance-types/\"\n  }), \"https://aws.amazon.com/ec2/instance-types/\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"IBM API Connect V10 Knowledge Center - Kubernetes Install\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.ibm.com/support/knowledgecenter/SSMNED_v10/com.ibm.apic.install.doc/capic_planning_deployment_kubernetes.html\"\n  }), \"https://www.ibm.com/support/knowledgecenter/SSMNED_v10/com.ibm.apic.install.doc/capic_planning_deployment_kubernetes.html\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Obtaining Install Files\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.ibm.com/support/knowledgecenter/SSMNED_v10/com.ibm.apic.install.doc/tapic_install_Kubernetes_firststeps.html\"\n  }), \"https://www.ibm.com/support/knowledgecenter/SSMNED_v10/com.ibm.apic.install.doc/tapic_install_Kubernetes_firststeps.html\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Initial Configuration Checklist\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.ibm.com/support/knowledgecenter/SSMNED_v10/com.ibm.apic.cmc.doc/rapic_cmc_checklist.html\"\n  }), \"https://www.ibm.com/support/knowledgecenter/SSMNED_v10/com.ibm.apic.cmc.doc/rapic_cmc_checklist.html\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Install eksctl\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.aws.amazon.com/eks/latest/userguide/getting-started-eksctl.html#install-eksctl\"\n  }), \"https://docs.aws.amazon.com/eks/latest/userguide/getting-started-eksctl.html#install-eksctl\"), \"\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.aws.amazon.com/eks/latest/userguide/create-cluster.html\"\n  }), \"https://docs.aws.amazon.com/eks/latest/userguide/create-cluster.html\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Install kubectl\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://kubernetes.io/docs/tasks/tools/install-kubectl/\"\n  }), \"https://kubernetes.io/docs/tasks/tools/install-kubectl/\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Install Helm\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://helm.sh/docs/intro/install/\"\n  }), \"https://helm.sh/docs/intro/install/\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"AWS CLI\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html\"\n  }), \"https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"AWS IAM\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.aws.amazon.com/eks/latest/userguide/install-aws-iam-authenticator.html\"\n  }), \"https://docs.aws.amazon.com/eks/latest/userguide/install-aws-iam-authenticator.html\")))));\n}\n;\nMDXContent.isMDXComponent = true;","tableOfContents":{"items":[{"url":"#install-apic-v10-on-amazon-eks","title":"Install APIC V10 on Amazon EKS"},{"url":"#summary","title":"Summary"},{"url":"#create-eks-cluster","title":"Create EKS Cluster"},{"url":"#download-apic-related-crds","title":"Download APIC Related CRDs"},{"url":"#install-ingress-and-cert-manager","title":"Install Ingress and Cert Manager"},{"url":"#configure-route53-dns","title":"Configure Route53 DNS"},{"url":"#apply-crds-and-customize-apic-subsystem-deployment","title":"Apply CRDs and Customize APIC Subsystem Deployment"},{"url":"#update-node-vmmax_map_count","title":"Update Node vm.max_map_count"},{"url":"#cluster-accessmanagement","title":"Cluster Access/Management","items":[{"url":"#logging-into-a-cluster-node","title":"Logging into a Cluster Node"},{"url":"#cluster-access","title":"Cluster Access"},{"url":"#deleting-cluster","title":"Deleting Cluster"}]},{"url":"#references","title":"References"}]},"parent":{"__typename":"File","relativePath":"apic-v10-eks/README.md"},"frontmatter":{"metaTitle":null,"metaDescription":null}},"allMdx":{"edges":[{"node":{"fields":{"slug":"/","title":"Landing Page"}}},{"node":{"fields":{"slug":"/codeblock","title":"Syntax Highlighting"}}},{"node":{"fields":{"slug":"/introduction","title":"Introduction"}}},{"node":{"fields":{"slug":"/apic/apic-cli","title":"Apic Cli"}}},{"node":{"fields":{"slug":"/apic/apic-use-case-resources","title":"Apic Use Case Resources"}}},{"node":{"fields":{"slug":"/apic/third-part-oauth-okta","title":"Third Part Oauth Okta"}}},{"node":{"fields":{"slug":"/codeblock/1-index.md","title":"Sub Page"}}},{"node":{"fields":{"slug":"/mq-portworx/multiinstance","title":"Multiinstance"}}},{"node":{"fields":{"slug":"/ace-es/ace-esv10-v2020.2/ace-esv10-v2020.2","title":"Ace Esv 10 V 2020 2"}}},{"node":{"fields":{"slug":"/ace-mq-tls/ace-mqv9.1.5-r2-tls-v2020.2/Create KDB","title":"Create KDB"}}},{"node":{"fields":{"slug":"/ace-mq-tls/ace-mqv9.1.5-r2-tls-v2020.2/ace-mqv9.1.5-r2-tls-v2020.2","title":"Ace Mqv 9 1 5 R 2 Tls V 2020 2"}}},{"node":{"fields":{"slug":"/apic-v10-eks/README","title":"README"}}},{"node":{"fields":{"slug":"/ace-oracledb/ace-oracledb-v2020.2/ace-oracledb-v2020.2","title":"Ace Oracledb V 2020 2"}}},{"node":{"fields":{"slug":"/ace-soap-create-route-ocp/ace-soap-v2020.2/ace-soap-v2020.2","title":"Ace Soap V 2020 2"}}},{"node":{"fields":{"slug":"/es-mq/esv10-mq-v2020.2/esv10-mq-v2020.2","title":"Esv 10 Mq V 2020 2"}}}]}},"pageContext":{"id":"cbc12435-120f-5b05-acc6-d876b924f360"}},"staticQueryHashes":["2619113677","2619113677","3706406642","3706406642","417421954","417421954"]}